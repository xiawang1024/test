<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
	*{padding: 0;margin:0;}
		#div{
			position: relative;
		}
		.box{
			padding: 15px 0 0 15px;
			float: left;
		}
		.pic{
			border: 1px solid gray;
			padding: 15px;
			border-radius: 5px;
			box-shadow: 0 0 5px gray;
		}
		.pic img{display: block;
			width: 200px;height: auto;
			/*position: ;*/
			}
	</style>
</head>
<body>
	<div id='div'>
		<div class="box">
			<div class="pic"><img src="images/0.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/1.jpg"></div>
		</div>
		<div class="box">		
			<div class="pic"><img src="images/2.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/3.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/4.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/5.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/6.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/7.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/8.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/9.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/10.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/11.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/12.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/13.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/14.jpg"></div>
		</div>

		<div class="box">
			<div class="pic"><img src="images/15.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/16.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/17.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/18.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/19.jpg"></div>
		</div>
		<div class="box">
			<div class="pic"><img src="images/20.jpg"></div>
		</div>
	</div>
	<script type="text/javascript">
		var oDiv=document.getElementById('div');
		waterFall("div","box");
		window.onresize=function(){waterFall("div","box");console.log(document.documentElement.clientWidth)}
		function waterFall(parent,box){
			var oParent=document.getElementById(parent);
			var oBoxs=oParent.getElementsByClassName(box);
			var oBoxW=oBoxs[0].offsetWidth;
			//计算列数
			var cols=Math.floor(document.documentElement.clientWidth/oBoxW);
			oParent.style.width=oBoxW*cols+"px";
			oParent.style.margin="0 auto";
			var hArr=[];
			for(var i=0;i<oBoxs.length;i++){
				if(i<cols){
					hArr.push(oBoxs[i].offsetHeight);
				}else{
					var hMin=Math.min.apply(null,hArr);
					var index=getIndex(hArr,hMin);
					oBoxs[i].style.position="absolute";
					oBoxs[i].style.top=hMin+"px";
					oBoxs[i].style.left=oBoxs[index].offsetLeft+"px";
					// console.log(hMin);
					hArr[index]+=oBoxs[i].offsetHeight;
				}
			}
			console.log(oBoxW);
		}
		function getIndex(arr,item){
			for(var i=0;i<arr.length;i++){
				if(item===arr[i]){
					return i;
					break;
				}
			}
		}
	</script>
</body>
</html>